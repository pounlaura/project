<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>Road to Local Law 97</title>
   	<script src="https://d3js.org/d3.v4.min.js"></script>
   	<link href="Local%20Law%2097_files/css.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="css/bootstrap.css"> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ScrollMagic/2.0.5/ScrollMagic.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css">
    <!-- map links -->

    <script src="https://api.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.css" rel="stylesheet" />
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-compare/v0.4.0/mapbox-gl-compare.js"></script>
    <link
        rel="stylesheet"
        href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-compare/v0.4.0/mapbox-gl-compare.css"
        type="text/css"
    />

<style>

    @media (min-width: 768px){
      .container.customcontainer {
        max-width: none;
        padding: 0;
      }
      .container.bodycontainer {
        padding: 30px;
      }
    }
    p.byline {
      color: white;
      opacity: 1;
    }
    p.timeline {
      text-align: left;
    }
    p.caveat {
      font-size: 10px;
    }
		p {
			font-family: 'Open Sans', sans-serif;
			color:#353536;
			font-weight:300;
      line-height: 1.7;
		}


    ol {
			font-family: 'Open Sans', sans-serif;
			color:#353536;
			font-weight:400;
		}

		svg {
			width:100%;
			/* height:500px; */
			padding-left:5%;
			padding-right:50px;
		}

		h1 {
			font-size:60px;
			font-weight:200;
			line-height:1.3;
		}
    h5 {
      color: #214B47;
    }
    h1.story-heading {
      font-weight:400;
      font-family: "Montserrat", sans-serif;

    }

    figcaption {
    /* font-family: Verdana, Geneva, sans-serif; */
    font-size: 8px;
    /* text-shadow: none; */
    /* color: black; */
    text-align: left;
    word-wrap:  break-word;
    width:400px;
    }
/* header style */
main header.story-header {
  background-color: #214B47;
  background-size: cover;
  background-repeat: no-repeat;
  /* opacity: 0.6; */
  height: 100vh;
  position: relative;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-align: center;
  align-items: center;
  -ms-flex-pack: start;
  justify-content: flex-start;
  z-index: 99;
}
main header.story-header .story-meta {
  z-index: 2;
  padding: 2rem 2rem 3rem;
  color: white;
  -ms-flex-item-align: end;
  align-self: flex-end;
  animation: fadeIn;
  animation-delay: 4s;
  animation-duration: 2s;
  animation-fill-mode: both;
  width: 100%;
}
main h4.section-header {
    font-size: 3.5rem;
    width: 33rem;
    padding: 1rem;
    text-indent: -0.2em;
    margin-left: 4rem;
    margin-bottom: 2rem;
    margin-top: 4rem;
}
article {
  position: relative;
}
figure.sticky {
  position: -webkit-sticky;
  position: sticky;
  top: 0;
}
/* making timeline container sticky */
    .timelineSticky {
      position: -webkit-sticky;
      position: sticky;
      top:-1px;
      height: 1500px;
      margin-bottom: 80%;
    }
/* making timeline sticky */
    #timelinediv {
      position: -webkit-sticky;
      position: sticky;
      top: 50px;
    }

/* making firstvisualdiv and secondvisualdiv sticky */
    #firstvisualdiv, #secondvisualdiv {
        position: -webkit-sticky;
        position: sticky;
        top: -1px;
        }
    .emissionsTextColumn {
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      height: 3000px;
    }
    .emissionsTextColumn h5.sticky {
      position: sticky;
      top: 50%;
      transform: translateY(-50%);
    }
    .squaresvg {
      position: sticky;
      top: 50%;
      transform: translateY(-50%);
    }

/* hide and reveal scrolly css */
        .hidden {
        		opacity: 0;
        		-webkit-transform: scale(0.9);
        			 -moz-transform: scale(0.9);
        				-ms-transform: scale(0.9);
        				 -o-transform: scale(0.9);
        						transform: scale(0.9);
        		-webkit-transition: all .5s ease-in-out;
        			 -moz-transition: all .5s ease-in-out;
        				-ms-transition: all .5s ease-in-out;
        				 -o-transition: all .5s ease-in-out;
        						transition: all .5s ease-in-out;
        	}
        	.visible {
        		opacity: 1;
        		-webkit-transform: none;
        			 -moz-transform: none;
        				-ms-transform: none;
        				 -o-transform: none;
        						transform: none;
        	}
    /* .text1opacity, .text2opacity, .text3opacity {
        font-size:30px;
        fill:blue;
        opacity:0;
        transition: opacity 0.8s;
        -webkit-transition: opacity 0.8s;
        } */
/* highlight text css */
    .active1 {
        opacity:1;
        background-color: #00A780;
        color: white;
        font-weight:400;
        }

    .active2 {
        opacity:1;
        background-color: #FF7A2A;
        color: white;
        font-weight:400;
        }
    }

/* styles for firstsection */
    .firstsection {
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      height: 1500px;
    }

    .firstsection > div.hidden.visible {
      position: sticky;
      top: 25%;
    }

    .firstsection > div.hidden {
      position: static;
    }
/* style for row */
    .row {
      margin-bottom: 100px;
    }

    .center{
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
  /**
    * Map-related Styles
  */
    .maprow {
      position: relative;
      margin-left: calc((-100vw + 1140px - 60px)/2);
      width: 100vw;
      height: 100vh;
    }

    .maptitle {
      display: flex;
      margin-left: calc((-100vw + 1140px - 30px)/2);
      width: 100vw;
    }

    .maptitle > div {
      flex: 0 0 50%;
    }

    .map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
      z-index: 0;
    }

    .map-overlay {
      position: absolute;
      top: 20px;
      left: 20px;
      background: #CEDED6;
      background-opacity: .5;
      font-family: 'Open Sans', sans-serif;
      font-size: 12px;
			color:#353536;
			font-weight:500;
      line-height: 1.7;

    }

	</style>
</head>
<body>
  <main role="main" class="container customcontainer">
    <header class="story-header interactive-header">
              <div class="story-meta">

                <h1 class="story-heading interactive-headline" itemprop="headline" style="white-space: normal; float: none; display: block; position: static;">The Real Path to<br data-owner="balance-text">Reducing NYC's Emissions</h1>
                <div class="story-meta-footer interactive-meta-footer">
                  <div class="interactive-byline">
        <p class="byline">Amber Kim, Laura Kim, Jordan Owen <br></br>
          Big Data and Visualization Spring 2020 | Massachusetts Institute of Technology
        </p>
      </div>
                </div>
              </div>
            </header>
     <!--Intro/Background on 80 x 50-->
     <main role="main" class="container bodycontainer">
       <br>
       <!-- <h4 class="section-header">NYC's Green New Deal
       </h4> -->
       <br>
       <!-- <p> In 2019, New York City (NYC) enacted <a href="https://www1.nyc.gov/assets/buildings/local_laws/ll97of2019.pdf">Local Law 97
       (LL97)</a>, an ambitious law that sets greenhouse gas (GHG) emissions reductions limits for NYC's
       buildings as part of the city's efforts to reduce GHG emissions by
       80% by 2050. This new legislation sets limits on carbon emissions that come from energy use in large buildings.
       Starting in 2024, building owners will be fined if their buildings emit more than the designated emissions cap.
       We delved into the regulations and currently available emissions data to gain insights on what it means for NYC to achieve the law's goals.
      </p> -->
      <br>
      <div class="row">
        <div id ="trigger1" class="spacer s0"></div>
        <div class="col-4 hidden" id="reveal1">
          <h5>
            NYC has charted a path to reducing its greenhouse gas(GHG) emissions by 80% by 2050.
          </h5>
          <!-- <h5>
            What does the path look like?
          </h5> -->
        </div>
        <div class="col-8 hidden" style="padding: 30px">

        </div>
      </div>
      <div class="row">

        <div class="col-4 firstsection">
        <div id ="trigger2" class="spacer s0"></div>

          <div id="firstsection1" class="hidden">
            <!-- <div class= -->
            <h5>#GreenNewDeal4NY</h5>
            <p>
              TALK ABOUT THE CLIMATE MOBILIZATION ACT HERE
              <br>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>
          </div>
          <div id="firstsection2" class="hidden">
            <!-- <div class= -->
            <h5>Local Law 84 requires building owners to report emissions every year</h5>
            <p>
              [talk about 25,000 sq. ft. requirement and how this data lays the groundwork for LL97]
              <br>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>
          </div>
          <div id="firstsection3" class="hidden">
            <!-- <div class= -->
            <h5>Third paragraph for scrolling section</h5>
            <p>
              Third topic
              <br>
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
            </p>
          </div>

        </div>
        <div class="col-8 timelineSticky">
          <div id ="trigger3" class="spacer s0"></div>
          <div id="timelinediv" class="hidden" style="border-left: 5px solid #CEDED6; padding: 30px">
          <p class="timeline">
            <span id="timeline1">Benchmarking Data - Local Law 84 (2009)</span>
            <br><br>
            Local Law 133 (2016)
            <br><br>
            Local Law 33 (2018)
            <br><br>
            TKTK
            <br><br>
            TKTK
            <br><br>
            TKTK
            <br><br>
            Power Plant Phaseout Study - Int. 1318
            <br><br>
            Building Efficiency Grades - Int. 1251
            <br><br>
            PACE Financing - Local Law 96 (2019)
            <br><br>
            <span id="timeline2">Building Retrofits - Local Law 97 (2019)</span>
            <br><br>
          </p>
          </div>

      </div>
</div>
      <br>
      <!-- diagram 1 -->
<div class="row">
        <div class="col-4 emissionsTextColumn">
          <h5 id="emissionsHeadline1">NYC's annual emissions are 50.7 million metric tons.</h5>
          <h5 id="emissionsHeadline2">Buildings are responsible for 70% of NYC's emissions.</h5>
          <h5 id="emissionsHeadline3">Covered buildings under LL84 emitted 19.5 million metric tons in 2018.
          <p class="caveat">*estimated emissions from [20,000] covered buildings</p></h5>
          <h5 id="emissionsHeadline4">LL97 aims to reduce at least 5.3 million metric tons by 2030 from covered buildings.</h5>
        </div>
      <div class="col-8" id="firstvisualdiv">
        <br><br>
        <!-- <div id="firstvisualdiv"> -->
         <div class="squaresvg">
           <figcaption style="padding-left: 40px">1 square = 10000 metric tons; Source: NYC GHG Inventory 2017
           </figcaption>
         </div>

        <br><br><br>
            <!-- </div> -->
        </div>
        <br>
</div>
<!-- transition -->
<div class="row">
  <div class="col-4">
    <h5>How much GHG emissions does each covered building have to reduce to meet LL97 goals?
    </h5>
  </div>
  <div class="col-8">
  </div>
</div>
<!-- map intro -->
<div class="row">
        <div class="col-4">
          <br><br>
          <h5>Large gaps in data make it difficult to visualize LL97.</h5>
          <p> Under LL97's covered buildings qualifications, 50,000 buildings throughout all 5 boroughs should be subject to comply.
            However, LL84's dataset reveals around half that number--indicating insufficient data.

          </p>

         </div>
      <div class="col-8">
      </div>
    </div>

<div class="maptitle">
    <div>
      <h5 style= "color: #FF7A2A">Buildings that are subject to LL97
      </h5>
    </div>
    <div>
      <h5 style="color: #00A780">Buildings that reported emissions under LL84
      </h5>
    </div>
</div>
<!-- slider map -->
<div class="maprow">
  <div id="comparison-container">

    <div id="before" class="map"></div>
    <div id="after" class="map"></div>
		<!-- <div class='map-overlay' id='features'><h5>Visualizing Data Gaps for Local Law 97</h5>
			<div id='pd'>
  			<p>Swipe and pan around the map to explore which covered buildings that have no emissions data.</p>
  			<p>Left Map: Estimated Covered Buildings</p>
  			<p>Right Map: Covered Buildings with Data</p>
  			<p>Source: NYC PLUTO and Local Law 84 Disclosure Data</p>
      </div> -->
    </div>
  </div>
</div>

<!-- map source -->
<div class="maptitle">
    <div>
      <figcaption>Source: PLUTO
      </figcaption>
    </div>
    <div>
      <figcaption>Source: Energy and Water Disclosure Data for Local Law 84 (2019)
      </figcaption>
    </div>
</div>

      <div class="row">
        <div class="col-4">
          <br><br>
          <h7>Local Law 97:</h7>
          <!-- <br>
           <p>
             [EDIT] The law indicates that approximately 60% of NYC's building area is
covered under the law, translating to about 50,000 buildings. Updating
and retrofiting 50,000 bulidings in the next four years is a tall task that
 can be difficult to comprehend. Thousands of landlords will have to
take action and NYC will have to implement programs to support building
retrofits and monitor progress. </p>
             <br> -->

           <br>
         </div>
           <div class="col-8">
             <br>
             <p>
              <br>
              <ul>
              <li>Affects buildings greater than 25,000 square feet</li>
              <li>Sets increasingly stringent limits on carbon emissions per
              square foot in 2024 and 2030</li>
              <li>Flexibility to comply through renewable energy credits and/or
              emissions offsets </li>
              <li>Allows some affordable housing to choose low-cost energysaving measures instead of emissions limits</li>
              <li>Creates a new Office of Building Energy and Emissions Performance at
              Department of Buildings</li>
              <li>Strong advisory board to help refine emissions metrics and
              limits</li>
              <li>Carbon trading study and implementation plan</li>
              <li>Penalties for non-compliance and variances for financial
              hardship</li>
             </ul>
             </p>
               <br>
         </div>
         <br>

</div>


  </main><!-- /.container -->


<script type="text/javascript">

var controller = new ScrollMagic.Controller();

      new ScrollMagic.Scene({triggerElement: "#trigger1",
                            triggerHook: 0.9,
                            duration: "58%",
                            offset: 50
                              })
          .setClassToggle("#reveal1", "visible")
          .addTo(controller);


      // firstsection paragraph 1
      new ScrollMagic.Scene({triggerElement: "#trigger2",
                            triggerHook: "onleave",
                            duration: "58%",
                            offset: 50
                              })
          .setClassToggle("#firstsection1", "visible")
          .addTo(controller);

//highlight text
          new ScrollMagic.Scene({
            triggerElement: "#firstsection2",
            duration: "30%",
          })
              .setClassToggle("#timeline1", "active1")
              .addTo(controller);

          new ScrollMagic.Scene({triggerElement: "#firstsection3"})
              .setClassToggle("#timeline2", "active2")
              .addTo(controller);

      // firstsection paragraph 2
      new ScrollMagic.Scene({triggerElement: "#trigger2",
                            triggerHook: "onleave",
                            duration: "30%",
                            offset: 500
                              })
          .setClassToggle("#firstsection2", "visible")
          .addTo(controller);

          // scene for paragraph 3
      new ScrollMagic.Scene({triggerElement: "#trigger2",
                            triggerHook: "onleave",
                            duration: "58%",
                            offset: 800
                              })
          .setClassToggle("#firstsection3", "visible")
          .addTo(controller);
          // scene for timeline
      new ScrollMagic.Scene({triggerElement: "#trigger3",
                            triggerHook: "onleave",
                            duration: 0,
                            offset: 50
                              })
          .setClassToggle("#timelinediv", "visible")
          .addTo(controller);
          // scene for diagram texts
      new ScrollMagic.Scene({
        triggerElement: "#emissionsHeadline1",
        triggerHook: "onCenter",
        duration: "10%",
      })
      .setClassToggle("#emissionsHeadline1", "sticky")
      .addTo(controller);

//scene for diagram 1
      new ScrollMagic.Scene({
        triggerElement: "#emissionsHeadline1",
        triggerHook: "onEnter",
        duration: 0,
      })
      .addTo(controller)
      .on('enter', squaresFill);
// scene for diagram 2
      new ScrollMagic.Scene({
        triggerElement: "#emissionsHeadline2",
        triggerHook: "onEnter",
        duration: 0,
      })
      .addTo(controller)
      .on('enter', squaresBuildings);
// scene for diagram 3
      new ScrollMagic.Scene({
        triggerElement: "#emissionsHeadline3",
        triggerHook: "onEnter",
        duration: 0,
      })
      .addTo(controller)
      .on('enter', squaresTransition);
// scene for diagram 4
      new ScrollMagic.Scene({
        triggerElement: "#emissionsHeadline4",
        triggerHook: "onEnter",
        duration: 0,
      })
      .addTo(controller)
      .on('enter', squaresMove);

//diagram 1
      function squaresFill(){
        var squares = d3.select('.squaresvg').selectAll('rect')
        .attr('fill', "#CEDED6")
        // .attr('fill', function(datum, index, nodes) {
        //   return index < 5071
        //   ? 'CEDED6'
        //   : d3.select(nodes[index]).attr('fill');
        // })
      }
// diagram 2
      function squaresBuildings() {
        var squares = d3.select('.squaresvg').selectAll('rect')
          .attr('fill', function(datum, index, nodes){
            return index < 1730
              ? '#CEDED6'
              : '#214B47';
          })
      }
// diagram 3
      function squaresTransition() {
        var squares = d3.select('.squaresvg').selectAll('rect')
          .attr('fill', function(datum, index, nodes) {
            return index > 3120
            ? '#00A780'
            : d3.select(nodes[index]).attr('fill');
          })
         d3.select('figcaption').html("<span>1 square = 10000 metric tons; Source: Energy and Water Disclosure Data for Local Law 84 (2019)</span>");
      }
// diagram 4
      function squaresMove () {
        var squaresvg = d3.select('.squaresvg');
        var stayEmissions = squaresvg.select('.stayEmissions');
        var reducedEmissions = squaresvg.select('.reducedEmissions');

        stayEmissions.transition()
        .duration(1000)
        .attrTween("transform", function(){
          return function(t) {
            return "scale("+ (1 - t*.1) +")";
          }
        });

        reducedEmissions.transition()
        .duration(1000)
        .attrTween("transform", function(){
          return function(t) {
            return `
            translate(0, ${t*15})
            scale(${1 - t*.1})
            `;
          }
        });
        d3.select('.reducedEmissions').selectAll('rect')
        .transition()
        .duration(1000)
        .attrTween("x", function(datum, index){
          return function(t){
            const originalPosition = (index * 8)%600;
            const finalPosition = (index *8)%304;
            return originalPosition - t*(originalPosition-finalPosition);
        }})
        .attrTween("y", function(datum, index){
          return function(t){
            var originalPosition = Math.floor(((index + 4541)*8)/600) * 8;
            var finalPosition = ((4541*8)/600*8) + (Math.floor(index / 38) * 8);
            return originalPosition - t*(originalPosition - finalPosition);
          }
        });

        d3.select('figcaption').html("<span>1 square = 10000 metric tons; Source: Urban Green Council, Local Law 97</span>");
      }

      // save for later
      // function translateAlong(path) {
      //   var l = path.getTotalLength();
      //   return function(d, i, a) {
      //     return function(t) {
      //       var p = path.getPointAtLength(t * l);
      //       return "translate(" + p.x + "," + p.y + ")";
      //     };
      //   };
      // }

var scrollVis = function() {
  var width = 600;
  var height = 550;
  var margin = {top:0, left:20, bottom: 0, right:10};

  var lastIndex = -1;
  var activeIndex = 0;

// sizing for grid viz
  var squareSize = 6;
  var squarePad = 2;
  var numPerRow = width/ (squareSize + squarePad);

// second diagram
  svg = d3.select('.squaresvg').insert('svg', ':first-child');
  svg.attr('width', width).attr('height', height);
  var stayEmissions = svg.append('g');
    stayEmissions.attr("class", "stayEmissions");
  var reducedEmissions = svg.append('g');
    reducedEmissions.attr("class", "reducedEmissions");

  var squares = [];

  // for (let i = 0; i<5071; i+=1){
  //  var square = allEmissions.append('rect').classed('square', true)
  //  .attr('width', squareSize)
  //  .attr('height', squareSize)
  //  .attr('fill', '#CEDED6')
  //  .attr('x', function() {
  //    return (i * 8)%600;
  //  })
  //  .attr('y', function() {
  //    return Math.floor((i*8)/600) * 8;
  //  })
  //  .attr('opacity', 1);
  //  squares.push(square);
  // }
  //building emissions
  for (let i = 0; i < 4541; i += 1) {
    var square = stayEmissions.append('rect').classed('square', true)
    .attr('width', squareSize)
    .attr('height', squareSize)
    .attr('fill', function() {
      return i < 1730
        ? '#CEDED6'
        : '#214B47';
    })
    .attr('x', function() {
      return (i * 8)%600;
    })
    .attr('y', function() {
      return Math.floor((i*8)/600) * 8;
    })
    .attr('opacity', 1);
    squares.push(square);
  }

  for (let i = 4541; i < 5071; i += 1) {
    var square = reducedEmissions.append('rect').classed('square', true)
    .attr('width', squareSize)
    .attr('height', squareSize)
    .attr('fill', function() {
      return i < 1730
        ? '#CEDED6'
        : '#214B47';
    })
    .attr('x', function() {
      return (i * 8)%600;
    })
    .attr('y', function() {
      return Math.floor((i*8)/600) * 8;
    })
    .attr('opacity', 1);
    squares.push(square);
  }
};




scrollVis();

mapboxgl.accessToken = 'pk.eyJ1IjoieWVraW05MiIsImEiOiJjazhueGlwdHMxM2s0M2ZxeDF5ZTN3azk2In0.M9yh1eYd5GJ6CYgW2hMoZA';
  var beforeMap = new mapboxgl.Map({
      container: 'before',
      style: 'mapbox://styles/yekim92/ck9rpo2qn0tzs1ioz0naklhry',
      center: [-73.922160,40.755840],
      zoom: 12,
      minZoom: 12,
      scrollZoom: false,

    });

  var afterMap = new mapboxgl.Map({
      container: 'after',
      style: 'mapbox://styles/yekim92/ck9qelzbo10t91iob7jlg7tbk',
      center: [-73.922160,40.755840],
      zoom: 12,
      minZoom: 12,
      scrollZoom: false,
  });
  // afterMap.on('load', function() {
  //       });
  // A selector or reference to HTML element
  var container = '#comparison-container';

  var map = new mapboxgl.Compare(beforeMap, afterMap, container, {
      // Set this to enable comparing two maps by mouse movement:
      // mousemove: true
  });
</script>











</body></html>
